<div class="construction-notice">
  <p>
    ðŸš§ This page is currently under construction. Please visit our
    <a
      href="https://www.signupgenius.com/go/10C0A4DAEA92EA4FFC16-50454986-soup#/"
      target="_blank"
      >temporary volunteer signup page</a
    >
    to register for shifts. ðŸš§
  </p>
</div>

<div class="calendar-container">
  <h1>Volunteer Schedule Management</h1>
  <blockquote>Manage volunteer shifts and schedules</blockquote>

  <div class="calendar">
    <div *ngFor="let day of calendarDays" class="calendar-day">
      <div class="day-header">
        <h3>{{ day.date | date : "E, MMM d" }}</h3>
      </div>
      <div class="day-content">
        <div *ngIf="day.shifts.length === 0" class="no-shifts">
          No shifts scheduled
        </div>
        <mat-card
          *ngFor="let shift of day.shifts"
          class="shift-card"
          (click)="viewShiftDetails(shift)"
        >
          <mat-card-content>
            <h4>Volunteer Shift</h4>
            <p>
              {{ formatTime(shift.StartTime) }} -
              {{ formatTime(shift.EndTime) }}
            </p>
            <div class="capacity-indicator">
              <div class="capacity-label">Capacity:</div>
              <div class="capacity-bar">
                <div
                  *ngIf="shift.signups"
                  class="capacity-filled"
                  [style.width]="
                    (getFilledSlots(shift) / shift.Capacity) * 100 + '%'
                  "
                ></div>
              </div>
              <div class="capacity-text">
                <span *ngIf="shift.signups"
                  >{{ getFilledSlots(shift) }}/{{ shift.Capacity }}</span
                >
                <span *ngIf="!shift.signups">0/{{ shift.Capacity }}</span>
              </div>
            </div>
            <div class="click-indicator">
              <mat-icon>info</mat-icon> Click for details
            </div>
          </mat-card-content>
        </mat-card>
      </div>
    </div>
  </div>

  <!-- Shift Details Modal -->
  <div *ngIf="showSignups && selectedShift" class="modal-backdrop">
    <div class="modal-content">
      <h2>Shift Details</h2>
      <p><strong>Date:</strong> {{ formatDate(selectedShift.StartTime) }}</p>
      <p>
        <strong>Time:</strong> {{ formatTime(selectedShift.StartTime) }} -
        {{ formatTime(selectedShift.EndTime) }}
      </p>

      <div class="capacity-summary">
        <strong>Capacity:</strong>
        <div class="capacity-bar modal-capacity">
          <div
            class="capacity-filled"
            [style.width]="
              (getFilledSlots(selectedShift) / selectedShift.Capacity) * 100 +
              '%'
            "
          ></div>
        </div>
        <span
          >{{ getFilledSlots(selectedShift) }}/{{
            selectedShift.Capacity
          }}
          slots filled</span
        >
      </div>

      <div class="signups-section">
        <h3>Volunteers ({{ selectedShift.signups?.length || 0 }})</h3>
        <div
          *ngIf="!selectedShift.signups || selectedShift.signups.length === 0"
          class="no-signups"
        >
          No volunteers have signed up yet
        </div>
        <div
          *ngIf="selectedShift.signups && selectedShift.signups.length > 0"
          class="signup-list"
        >
          <div *ngFor="let signup of selectedShift.signups" class="signup-card">
            <div class="signup-header">
              <strong>{{ signup.Name }}</strong>
            </div>
            <div class="signup-details">
              <p><mat-icon>email</mat-icon> {{ signup.Email }}</p>
              <p><mat-icon>phone</mat-icon> {{ signup.PhoneNumber }}</p>
              <p>
                <mat-icon>group</mat-icon> {{ signup.NumPeople }}
                {{ signup.NumPeople === 1 ? "person" : "people" }}
              </p>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-actions">
        <button mat-raised-button color="warn" (click)="closeSignupDetails()">
          Close
        </button>
      </div>
    </div>
  </div>
</div>
